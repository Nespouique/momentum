# Story 2.2: Exercise Library - UI

## Status: Ready for Review

## Story
**As a** user,
**I want** to browse, search, and add exercises to my library,
**so that** I can build my workout programs with the exercises I use.

## Acceptance Criteria
1. Page `/exercises` listant tous les exercices (bibliothÃ¨que unique partagÃ©e)
2. Filtres par groupe musculaire (tabs ou dropdown multi-sÃ©lection)
3. Barre de recherche par nom
4. Affichage en cards ou liste avec nom et badges groupes musculaires
5. Bouton "Ajouter un exercice" ouvrant un formulaire modal/drawer
6. Formulaire : nom (requis), groupes musculaires (requis, multi-sÃ©lection avec chips)
7. Actions edit/delete disponibles sur tous les exercices
8. Navigation accessible depuis le menu principal

## Tasks / Subtasks
- [x] CrÃ©er page liste exercices (AC: 1)
  - [x] CrÃ©er `app/(app)/exercises/page.tsx`
  - [x] Fetch exercices avec React Query
  - [x] Layout avec header et liste unique "BibliothÃ¨que"
- [x] ImplÃ©menter filtres (AC: 2)
  - [x] CrÃ©er composant MuscleGroupFilter
  - [x] Tabs ou dropdown multi-select
  - [x] Synchroniser avec query params URL
  - [x] Appeler API avec filtre
- [x] ImplÃ©menter recherche (AC: 3)
  - [x] Input de recherche avec debounce
  - [x] Filtrer cÃ´tÃ© client ou ajouter query param search
  - [x] Clear button
- [x] CrÃ©er composant ExerciseCard (AC: 4)
  - [x] Afficher nom de l'exercice
  - [x] Badges pour chaque groupe musculaire (couleurs diffÃ©rentes)
  - [x] Layout compact pour liste mobile
- [x] CrÃ©er modal/drawer ajout (AC: 5, 6)
  - [x] Bouton "+" ou "Ajouter un exercice"
  - [x] Drawer ou Dialog Shadcn
  - [x] Formulaire React Hook Form
  - [x] Input nom
  - [x] Multi-select groupes musculaires avec chips
  - [x] Validation Zod
  - [x] Submit â†’ POST /exercises
- [x] Actions edit/delete (AC: 7)
  - [x] Boutons edit/delete sur tous les exercices
  - [x] Edit â†’ ouvrir formulaire prÃ©-rempli
  - [x] Delete â†’ Dialog confirmation
- [x] Navigation (AC: 8)
  - [x] Ajouter dans navigation secondaire ou menu
  - [x] Accessible depuis Workout Builder aussi

## Dependencies
- Story 2.1: Exercise Library Backend (API endpoints)
- Story 1.3: Shadcn UI & Dark Theme (composants de base)
- Story 1.4: Authentication System (auth store, API client)

## Dev Notes

### Composants dÃ©jÃ  disponibles (Epic 1)
- **Input, Button, Card, Label** - Story 1.4
- **Dialog, Tabs, Calendar, Popover, Collapsible** - Story 1.6
- **Select** - Story 1.8
- **Sonner (toasts)** - Story 1.5
- Ã€ installer: Badge, DropdownMenu, Command (pour multi-select)

### API Client (ref Story 1.7)
L'API utilise un proxy Next.js pour les variables d'environnement runtime:
```typescript
// Utiliser le chemin /backend/ pour les appels API
const response = await fetch('/backend/exercises');
// OU via le client API existant qui gÃ¨re dÃ©jÃ  le prefix
```

### Page Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BibliothÃ¨que           + Add   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” [Search...              ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [All][Pecs][Dos][Bras][Jambes] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ DÃ©veloppÃ© couchÃ©    âœ ğŸ—‘â”‚   â”‚
â”‚  â”‚ ğŸ’ª pecs Â· triceps Â· Ã©paulesâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Curl biceps         âœ ğŸ—‘â”‚   â”‚
â”‚  â”‚ ğŸ’ª biceps               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Tractions           âœ ğŸ—‘â”‚   â”‚
â”‚  â”‚ ğŸ’ª dos Â· biceps          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Muscle Group Badges
```typescript
const muscleGroupColors: Record<MuscleGroup, string> = {
  pecs: 'bg-red-500/20 text-red-400',
  dos: 'bg-blue-500/20 text-blue-400',
  epaules: 'bg-yellow-500/20 text-yellow-400',
  biceps: 'bg-green-500/20 text-green-400',
  triceps: 'bg-purple-500/20 text-purple-400',
  quadriceps: 'bg-orange-500/20 text-orange-400',
  ischios: 'bg-pink-500/20 text-pink-400',
  fessiers: 'bg-indigo-500/20 text-indigo-400',
  abdos: 'bg-cyan-500/20 text-cyan-400',
  mollets: 'bg-teal-500/20 text-teal-400',
  trapezes: 'bg-lime-500/20 text-lime-400',
  lombaires: 'bg-amber-500/20 text-amber-400',
};
```

### Multi-Select Component
Utiliser un composant custom ou adapter Shadcn Select :
```tsx
<MultiSelect
  options={MUSCLE_GROUPS.map(mg => ({ value: mg, label: mg }))}
  selected={selectedGroups}
  onChange={setSelectedGroups}
  placeholder="SÃ©lectionner groupes musculaires"
/>
```

### React Query Hooks
```typescript
// hooks/useExercises.ts
export function useExercises(filters?: { muscleGroup?: string }) {
  return useQuery({
    queryKey: ['exercises', filters],
    queryFn: () => api.get('/exercises', { params: filters }),
  });
}

export function useCreateExercise() {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (data: CreateExerciseInput) => api.post('/exercises', data),
    onSuccess: () => queryClient.invalidateQueries({ queryKey: ['exercises'] }),
  });
}
```

### Components Shadcn
**DÃ©jÃ  installÃ©s:** Input, Button, Dialog, Tabs, Select
**Ã€ installer:**
```bash
npx shadcn@latest add badge
npx shadcn@latest add dropdown-menu
npx shadcn@latest add command  # Pour multi-select custom
```

### Zod Schema Frontend
```typescript
const exerciseFormSchema = z.object({
  name: z.string().min(2, 'Le nom doit faire au moins 2 caractÃ¨res'),
  muscleGroups: z.array(z.string()).min(1, 'SÃ©lectionnez au moins un groupe'),
});
```

## Testing
- VÃ©rifier que la liste affiche tous les exercices (bibliothÃ¨que partagÃ©e)
- Tester filtre par groupe musculaire
- Tester recherche par nom
- Tester crÃ©ation d'un exercice
- Tester modification d'un exercice
- Tester suppression avec confirmation

## Dev Agent Record

### Files Created/Modified
**New Files:**
- `apps/web/src/lib/api/exercises.ts` - API client for exercises CRUD
- `apps/web/src/lib/constants/muscle-groups.ts` - Muscle group colors and labels
- `apps/web/src/lib/validations/exercise.ts` - Zod validation schema for exercise form
- `apps/web/src/components/exercises/muscle-group-badge.tsx` - Colored badge component
- `apps/web/src/components/exercises/muscle-group-filter.tsx` - Horizontal scrollable filter pills
- `apps/web/src/components/exercises/exercise-card.tsx` - Exercise card with dropdown menu
- `apps/web/src/components/exercises/exercise-form-modal.tsx` - Create/edit form modal
- `apps/web/src/components/exercises/delete-exercise-dialog.tsx` - Delete confirmation dialog
- `apps/web/src/components/exercises/index.ts` - Barrel exports
- `apps/web/src/app/(app)/exercises/page.tsx` - Main exercises page

**Modified Files:**
- `apps/web/src/components/layout/mobile-bottom-nav.tsx` - Added Exercises nav item
- `apps/web/src/components/layout/desktop-sidebar.tsx` - Added Exercises nav item

### Shadcn Components Installed
- Badge
- DropdownMenu
- Checkbox

### Implementation Notes
- Used client-side search with debounce (300ms) for better UX
- Muscle group filter uses horizontal scrollable pills with "Tous" as default
- Exercise cards show colored badges for each muscle group
- Single "BibliothÃ¨que" list for all exercises (no custom/system separation)
- Edit/delete actions available on all exercises
- Form uses checkbox grid for muscle group multi-selection

### Completion Notes
- All acceptance criteria met
- Build passes, lint OK
- Navigation accessible from both mobile bottom nav and desktop sidebar
- Simplified to single shared library (removed isCustom distinction)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PO Sarah |
| 2026-01-19 | 1.0 | Implementation complete | Dev Agent (James) |
| 2026-01-19 | 1.1 | Simplified to shared library (removed custom/system separation) | Dev James |
