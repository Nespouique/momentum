# Story 4.1: Import des exercices Hercules

## User Story

**As a** user migrating from Hercules,
**I want** my custom exercises to be created in Momentum,
**So that** I can import my workout history with the correct exercise references.

## Background

Cette story fait partie de l'Epic 4: Migration Hercules → Momentum.
Fichier source : `docs/features/Hercule_18-01-2026_19h33m23s_v34.db`

## Acceptance Criteria

1. Script CLI exécutable via `npx tsx scripts/hercules-import-exercises.ts`
2. Création des 12 exercices manquants dans la base Momentum (production)
3. Génération d'un fichier de mapping `hercules-id → momentum-id` pour les stories suivantes
4. Aucun doublon créé si le script est relancé (idempotent)
5. Log des actions effectuées (créé, existant, mappé)

## Exercices à créer (12)

| Nom | Groupes musculaires |
|-----|---------------------|
| Cable fly | pecs |
| Tirage vertical | dos |
| Tirage horizontal | dos |
| Tirage sous horizontal | dos |
| Curl pupitre barre | biceps |
| Curl incliné | biceps |
| Curl concentré | biceps |
| Rotation externe épaule | epaules |
| Dips à la machine | triceps |
| Développé militaire à la machine | epaules, triceps |
| Oiseau à la poulie | epaules, dos |
| Split squat | quadriceps, fessiers |

## Mapping Hercules → Momentum (9 existants)

| Hercules Name | Momentum Name |
|---------------|---------------|
| Développé couché | Développé couché barre |
| Développé décliné à la machine | Declined chest press |
| Presse à buste | Chest press |
| Tractions poitrine prise large | Tractions |
| Curl marteau alterné avec haltères | Curl marteau |
| Extension triceps poulie haute en pronation | Triceps poulie haute |
| Élévations latérales avec haltères | Élévations latérales |
| Hip thrust | Hip thrust |
| Curl jambe assis | Leg curl |

## Exercices à ignorer (3)

- Étirements pecs
- Étirement table épaules
- Allongé raises (programme Épaules rééducation ignoré)

## Technical Notes

### Structure du script

```typescript
// scripts/hercules-import-exercises.ts

interface ExerciseMapping {
  herculesId: number;
  herculesName: string;
  momentumId: string;
  momentumName: string;
  action: 'created' | 'mapped' | 'ignored';
}

// 1. Connexion à la BDD Hercules (SQLite)
// 2. Connexion à la BDD Momentum (PostgreSQL prod)
// 3. Pour chaque exercice Hercules utilisé :
//    - Si dans la liste "à ignorer" → skip
//    - Si mapping existe → récupérer l'ID Momentum
//    - Sinon → créer l'exercice dans Momentum
// 4. Sauvegarder le mapping dans un fichier JSON
```

### Fichier de sortie

```json
// scripts/hercules-exercise-mapping.json
{
  "134": { "momentumId": "uuid-xxx", "name": "Développé couché barre" },
  "320": { "momentumId": "uuid-yyy", "name": "Declined chest press" },
  ...
}
```

### Connexion BDD Production

```
Host: 192.168.1.197
Port: 5432
Database: momentum
User: momentum
```

## Definition of Done

- [x] Script créé et testé
- [x] 12 exercices créés en production (13 au total, +1 mapping manquant)
- [x] Fichier de mapping JSON généré
- [x] Documentation mise à jour
- [x] Aucune erreur au relancement du script

## Dependencies

- Aucune

## Story Points

2 (Small)

---

## Dev Agent Record

### Status: Completed

### Agent Model Used
Claude Opus 4.5

### File List
| File | Action |
|------|--------|
| `scripts/hercules-import-exercises.ts` | Created |
| `scripts/hercules-exercise-mapping.json` | Generated |

### Completion Notes
- Script testé sur BDD dev (localhost:5432) avec succès
- 12 exercices à créer définis + 2 exercices MAPPER créés automatiquement si manquants
- Idempotence vérifiée : 0 doublons au relancement
- 21 exercices dans le mapping final (24 total - 3 ignorés)
- Prêt pour exécution sur la BDD de production

### Change Log
| Date | Change |
|------|--------|
| 2026-02-04 | Script créé et testé sur dev |
| 2026-02-04 | Exécuté sur prod: 13 créés, 8 mappés, 3 ignorés |
