# Story 3.2: Tracking Configuration - UI

## Status: Draft

## Story
**As a** user,
**I want** to configure what I track and set my goals,
**so that** the app adapts to my personal habits and objectives.

## Acceptance Criteria
1. Page `/settings/trackables` pour configuration des trackables
2. Liste des items track√©s avec toggle on/off pour chaque
3. Bouton "Ajouter un √©l√©ment" pour cr√©er un nouveau trackable
4. Formulaire TrackableForm : nom, ic√¥ne (s√©lecteur Lucide icons), couleur (color picker), type (checkbox/nombre/dur√©e), unit√© si nombre/dur√©e
5. Pour chaque item actif : configuration de l'objectif via modal/drawer
6. Options d'objectif : fr√©quence (quotidien/hebdomadaire/mensuel) + valeur cible
7. Possibilit√© de r√©ordonner les items (drag & drop, affecte l'ordre sur le dashboard)
8. Possibilit√© de supprimer un trackable personnalis√© (avec confirmation Dialog)
9. Le trackable "workout" est visible mais non modifiable/supprimable

## Tasks / Subtasks
- [ ] Cr√©er page configuration (AC: 1, 2)
  - [ ] `app/(app)/settings/trackables/page.tsx`
  - [ ] Fetch trackables avec React Query
  - [ ] Liste avec Switch toggle pour isActive
  - [ ] Distinguer trackables actifs/inactifs visuellement
- [ ] Bouton ajouter (AC: 3)
  - [ ] Bouton "+" ou "Ajouter un √©l√©ment"
  - [ ] Ouvre modal/drawer TrackableForm
- [ ] Cr√©er TrackableForm (AC: 4)
  - [ ] Input nom
  - [ ] S√©lecteur d'ic√¥ne Lucide (dropdown avec aper√ßu)
  - [ ] Color picker
  - [ ] Select type: Checkbox / Nombre / Dur√©e
  - [ ] Input unit√© (conditionnel si nombre/dur√©e)
  - [ ] Validation avec Zod
- [ ] Configuration objectif (AC: 5, 6)
  - [ ] Bouton "Configure goal" sur chaque trackable actif
  - [ ] Modal avec:
    - Select fr√©quence: Quotidien / Hebdomadaire / Mensuel
    - Input valeur cible
  - [ ] Afficher goal actuel si existant
  - [ ] POST/PUT goal √† la sauvegarde
- [ ] R√©ordonner items (AC: 7)
  - [ ] Drag handles sur chaque item
  - [ ] Utiliser dnd-kit
  - [ ] Persister l'ordre (ajouter champ order au mod√®le si n√©cessaire)
- [ ] Supprimer trackable (AC: 8)
  - [ ] Bouton trash sur items personnalis√©s
  - [ ] Dialog de confirmation
  - [ ] DELETE /trackables/:id
  - [ ] Invalider cache React Query
- [ ] Trackable workout prot√©g√© (AC: 9)
  - [ ] Afficher avec badge "System"
  - [ ] Masquer boutons edit/delete
  - [ ] Toggle actif toujours visible mais goal non modifiable

## Dev Notes

### Page Layout
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚Üê Settings                     ‚îÇ
‚îÇ  Tracking Configuration         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚â° üí™ Workout  [System]  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   Goal: 4√ó per week  üîí ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ              [ON/OFF]   ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ ‚â° üßò Yoga               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   Goal: daily      ‚öô   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ              [ON/OFF]   ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ ‚â° üëü Pas                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   Goal: 10,000/day ‚öô   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ              [ON/OFF]   ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ ‚â° üìñ Lecture (off)      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   No goal set      ‚öô   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ              [ON/OFF]   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  + Add New Trackable    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Icon Selector
Utiliser une liste des ic√¥nes Lucide courantes:
```typescript
const commonIcons = [
  'heart', 'star', 'zap', 'target', 'trophy',
  'book', 'code', 'coffee', 'music', 'palette',
  'brain', 'dumbbell', 'footprints', 'moon', 'sun',
  'droplet', 'flame', 'leaf', 'pill', 'bed',
];
```

### Color Picker
Options pr√©d√©finies + custom:
```typescript
const presetColors = [
  '#EF4444', // red
  '#F59E0B', // amber
  '#22C55E', // green
  '#3B82F6', // blue
  '#8B5CF6', // purple
  '#EC4899', // pink
  '#14B8A6', // teal
  '#6B7280', // gray
];
```

### TrackableForm Schema
```typescript
const trackableFormSchema = z.object({
  name: z.string().min(2).max(50),
  icon: z.string(),
  color: z.string().regex(/^#[0-9A-Fa-f]{6}$/),
  trackingType: z.enum(['boolean', 'number', 'duration']),
  unit: z.string().max(20).optional(),
});
```

### Goal Configuration Modal
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Configure Goal                 ‚îÇ
‚îÇ  Yoga                      ‚úï   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                 ‚îÇ
‚îÇ  Frequency                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Daily              ‚ñº    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ  Target                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ 5                       ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  times per week                 ‚îÇ
‚îÇ                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ      [Cancel]    [Save]         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Components Shadcn & Custom
- Switch (toggle on/off)
- Dialog (forms, confirmation)
- Select (type, frequency)
- Input
- Button
- Card
- MenuItem (composant custom pour chaque trackable dans la liste - cr√©√© en 1.5)
- MenuSection (composant custom pour grouper les trackables - cr√©√© en 1.5)
- NumberInput (composant custom pour la valeur cible des goals - cr√©√© en 1.5)

### React Query Mutations
```typescript
const updateTrackable = useMutation({
  mutationFn: (data) => api.put(`/trackables/${id}`, data),
  onSuccess: () => queryClient.invalidateQueries(['trackables']),
});

const createGoal = useMutation({
  mutationFn: ({ trackableId, ...data }) =>
    api.post(`/trackables/${trackableId}/goals`, data),
  onSuccess: () => queryClient.invalidateQueries(['trackables']),
});
```

## Testing
- Tester toggle on/off met √† jour isActive
- Tester cr√©ation d'un nouveau trackable
- Tester s√©lection d'ic√¥ne et couleur
- Tester configuration d'un goal
- Tester modification d'un goal existant
- Tester drag & drop pour r√©ordonner
- Tester suppression avec confirmation
- V√©rifier que workout ne peut pas √™tre modifi√©/supprim√©

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PO Sarah |
